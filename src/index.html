<!doctype html>
<html>
  <head>
    <title>server test</title>
    <!--  in html  -->
    <!--     CSS       -->
    <link rel="stylesheet" type="text/css" href="/css/styles.css">

  <style>
    .chart div {
      font: 10px sans-serif;
      background-color: steelblue;
      text-align: right;
      padding: 3px;
      margin: 1px;
      color: white;
    }

    .chart rect {
      fill: steelblue;
    }

    .chart text {
      fill: white;
      font: 10px sans-serif;
      text-anchor: end;
    }
  </style>

  <!-- scripts  -->
  <script src="/js/main.js"></script>

  </head>
  <body>
    <svg class="chart"></svg>
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>

    <!--  D3  -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>

    let data = '[{"id":116,"created":"2016-07-20T05:08:38.000Z","outTemp":47.6,"outHum":86,"inTemp":17.8,"barom":101657,"alt":39.99,"curWindS":0,"curWindG":0,"curWindD":112.5,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0,"windGustMin":0,"windGustMax":0,"windDirMin":90,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":115,"created":"2016-07-20T05:04:28.000Z","outTemp":47.7,"outHum":85.6,"inTemp":18,"barom":101663,"alt":39.91,"curWindS":0,"curWindG":0,"curWindD":135,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0.96,"windGustMin":0,"windGustMax":1.12,"windDirMin":135,"windDirMax":135,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":114,"created":"2016-07-20T04:50:57.000Z","outTemp":47.9,"outHum":85.1,"inTemp":18,"barom":101667,"alt":39.82,"curWindS":0,"curWindG":0,"curWindD":90,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0,"windGustMin":0,"windGustMax":0,"windDirMin":90,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":113,"created":"2016-07-20T04:50:37.000Z","outTemp":48,"outHum":85.1,"inTemp":18,"barom":101657,"alt":39.33,"curWindS":0,"curWindG":0,"curWindD":90,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0,"windGustMin":0,"windGustMax":0,"windDirMin":90,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":112,"created":"2016-07-20T04:48:02.000Z","outTemp":48,"outHum":85.1,"inTemp":18,"barom":101653,"alt":40.16,"curWindS":0,"curWindG":0,"curWindD":157.5,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0,"windGustMin":0,"windGustMax":0,"windDirMin":157.5,"windDirMax":157.5,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":111,"created":"2016-07-20T04:30:37.000Z","outTemp":48.3,"outHum":84.7,"inTemp":17.8,"barom":101633,"alt":40,"curWindS":3.84,"curWindG":4.21,"curWindD":180,"rainTot":0,"windSpeedMin":0,"windSpeedMax":3.84,"windGustMin":0,"windGustMax":4.84,"windDirMin":180,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":110,"created":"2016-07-20T04:10:37.000Z","outTemp":48.8,"outHum":81.5,"inTemp":19.3,"barom":101592,"alt":40.44,"curWindS":0,"curWindG":0,"curWindD":180,"rainTot":0,"windSpeedMin":0,"windSpeedMax":2.4,"windGustMin":0,"windGustMax":2.66,"windDirMin":180,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":109,"created":"2016-07-20T03:50:37.000Z","outTemp":49.1,"outHum":80.7,"inTemp":19.4,"barom":101567,"alt":39.94,"curWindS":0,"curWindG":0,"curWindD":180,"rainTot":0,"windSpeedMin":0,"windSpeedMax":0.96,"windGustMin":0,"windGustMax":0.98,"windDirMin":180,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":108,"created":"2016-07-20T03:30:36.000Z","outTemp":49.5,"outHum":81.6,"inTemp":19,"barom":101562,"alt":39.7,"curWindS":0,"curWindG":0,"curWindD":180,"rainTot":0,"windSpeedMin":0,"windSpeedMax":5.76,"windGustMin":0,"windGustMax":5.34,"windDirMin":180,"windDirMax":202.5,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":107,"created":"2016-07-20T03:10:36.000Z","outTemp":50,"outHum":80.3,"inTemp":19.3,"barom":101562,"alt":39.95,"curWindS":0.48,"curWindG":0.22,"curWindD":180,"rainTot":0,"windSpeedMin":0.48,"windSpeedMax":9.12,"windGustMin":0.22,"windGustMax":8.18,"windDirMin":180,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":106,"created":"2016-07-20T02:50:36.000Z","outTemp":50.6,"outHum":79.3,"inTemp":19.8,"barom":101587,"alt":39.35,"curWindS":3.84,"curWindG":3.24,"curWindD":180,"rainTot":0,"windSpeedMin":0,"windSpeedMax":13.92,"windGustMin":0,"windGustMax":21.77,"windDirMin":135,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":105,"created":"2016-07-20T02:30:36.000Z","outTemp":19.2,"outHum":53.8,"inTemp":20,"barom":101588,"alt":39.85,"curWindS":5.76,"curWindG":4.73,"curWindD":135,"rainTot":0,"windSpeedMin":0,"windSpeedMax":5.76,"windGustMin":0,"windGustMax":5.44,"windDirMin":135,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":104,"created":"2016-07-19T23:51:52.000Z","outTemp":21.4,"outHum":49.6,"inTemp":21.7,"barom":101656,"alt":39.08,"curWindS":7.2,"curWindG":8.6,"curWindD":180,"rainTot":0,"windSpeedMin":2.4,"windSpeedMax":16.8,"windGustMin":2.59,"windGustMax":15.49,"windDirMin":0,"windDirMax":202.5,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":103,"created":"2016-07-19T23:31:52.000Z","outTemp":21.6,"outHum":49.4,"inTemp":21.8,"barom":101685,"alt":40.73,"curWindS":4.8,"curWindG":6.98,"curWindD":180,"rainTot":0,"windSpeedMin":4.32,"windSpeedMax":12.96,"windGustMin":3.68,"windGustMax":14.18,"windDirMin":157.5,"windDirMax":180,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1},{"id":102,"created":"2016-07-19T23:11:57.000Z","outTemp":22.8,"outHum":47.2,"inTemp":23.7,"barom":101680,"alt":39.4,"curWindS":6.72,"curWindG":5.62,"curWindD":225,"rainTot":0,"windSpeedMin":0,"windSpeedMax":11.52,"windGustMin":0,"windGustMax":10.42,"windDirMin":180,"windDirMax":225,"engMetric":0,"station":"AlphaStationX-W","airQualSens":0,"airQualQual":-1}]';

    data = JSON.parse(data);
    data = data.map((curr, index) => {
      return curr.outTemp *10/2;
    })
    console.log('d3', data)
  // var data = [4, 8, 15, 16, 23, 42];

var width = 420,
    barHeight = 20;

var x = d3.scaleLinear()
    .domain([0, d3.max(data)])
    .range([0, width]);

var chart = d3.select(".chart")
    .attr("width", width)
    .attr("height", barHeight * data.length);

var bar = chart.selectAll("g")
    .data(data)
  .enter().append("g")
    .attr("transform", function(d, i) { return "translate(0," + i * barHeight + ")"; });

bar.append("rect")
    .attr("width", x)
    .attr("height", barHeight - 1);

bar.append("text")
    .attr("x", function(d) { return x(d) - 3; })
    .attr("y", barHeight / 2)
    .attr("dy", ".35em")
    .text(function(d) { return d; });
    </script>
  </body>
</html>
